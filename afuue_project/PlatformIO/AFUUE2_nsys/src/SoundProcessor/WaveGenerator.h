#include "SoundProcessorBase.h"

const float waveAfuueCla[256] = {
    -0.08316f,-0.14099f,-0.19882f,-0.25040f,-0.28775f,-0.32510f,-0.34079f,-0.34265f,-0.34451f,-0.31738f,-0.28760f,-0.25647f,-0.22083f,-0.18515f,-0.15909f,-0.14169f,
    -0.12427f,-0.11746f,-0.11276f,-0.10748f,-0.09839f,-0.08929f,-0.07700f,-0.06067f,-0.04434f,-0.03433f,-0.02649f,-0.01953f,-0.02835f,-0.03717f,-0.04980f,-0.06927f,
    -0.08875f,-0.11050f,-0.13345f,-0.15637f,-0.16904f,-0.18134f,-0.18808f,-0.18005f,-0.17206f,-0.16101f,-0.14777f,-0.13452f,-0.12668f,-0.11954f,-0.11273f,-0.10730f,
    -0.10184f,-0.09790f,-0.09552f,-0.09314f,-0.08694f,-0.07983f,-0.07175f,-0.05533f,-0.03891f,-0.02380f,-0.01053f,0.00272f,0.01154f,0.01859f,0.02533f,0.01868f,
    0.01199f,-0.00497f,-0.04333f,-0.08170f,-0.13736f,-0.20306f,-0.26877f,-0.31879f,-0.36774f,-0.40237f,-0.39212f,-0.38190f,-0.35077f,-0.30234f,-0.25394f,-0.21469f,
    -0.17700f,-0.14276f,-0.12674f,-0.11072f,-0.10129f,-0.09958f,-0.09784f,-0.10742f,-0.12039f,-0.13470f,-0.16605f,-0.19736f,-0.23615f,-0.28720f,-0.33823f,-0.39224f,
    -0.44760f,-0.50299f,-0.55032f,-0.59756f,-0.64059f,-0.67352f,-0.70645f,-0.72128f,-0.72409f,-0.72687f,-0.70911f,-0.68915f,-0.67014f,-0.65442f,-0.63873f,-0.62924f,
    -0.62549f,-0.62177f,-0.62631f,-0.63266f,-0.63907f,-0.64584f,-0.65265f,-0.65240f,-0.64288f,-0.63336f,-0.60901f,-0.57935f,-0.54855f,-0.49203f,-0.43552f,-0.36896f,
    -0.28360f,-0.19824f,-0.11105f,-0.02289f,0.06528f,0.12939f,0.19247f,0.24500f,0.26797f,0.29092f,0.29568f,0.28665f,0.27762f,0.26431f,0.25043f,0.23660f,
    0.22330f,0.20999f,0.19330f,0.17297f,0.15265f,0.14450f,0.13956f,0.13931f,0.18387f,0.22845f,0.28229f,0.34995f,0.41763f,0.45038f,0.46854f,0.48587f,
    0.42517f,0.36450f,0.29276f,0.19708f,0.10138f,0.02765f,-0.03268f,-0.09308f,-0.10541f,-0.11392f,-0.11688f,-0.10144f,-0.08603f,-0.07156f,-0.05789f,-0.04425f,
    -0.03995f,-0.03738f,-0.03375f,-0.02380f,-0.01385f,0.00171f,0.02414f,0.04660f,0.06766f,0.08829f,0.10806f,0.11523f,0.12241f,0.12238f,0.10999f,0.09760f,
    0.08539f,0.07321f,0.06107f,0.07925f,0.09808f,0.12622f,0.17783f,0.22940f,0.27811f,0.32483f,0.37155f,0.39233f,0.41006f,0.42230f,0.41251f,0.40274f,
    0.38034f,0.34564f,0.31094f,0.27121f,0.23029f,0.19046f,0.15891f,0.12735f,0.10608f,0.09897f,0.09186f,0.11148f,0.14120f,0.17178f,0.22968f,0.28754f,
    0.34827f,0.41461f,0.48093f,0.54071f,0.59680f,0.65289f,0.70242f,0.75159f,0.79822f,0.83731f,0.87640f,0.90631f,0.92892f,0.95151f,0.96246f,0.97156f,
    0.97421f,0.94513f,0.91605f,0.86423f,0.78708f,0.70996f,0.61624f,0.51779f,0.42032f,0.33359f,0.24683f,0.16879f,0.10437f,0.03995f,-0.02530f,-0.09091f,
};

class WaveGenerator : public SoundProcessorBase {
public:
    void Initialize() override {
        // Preferences からデータ復帰したり？
    }

    void ProcessAudio(SoundInfo& info) override {
        m_phase += info.tickCount;
        if (m_phase >= 1.0f) m_phase -= 1.0f;

        info.wave = InteropL(waveAfuueCla, 256, m_phase) * info.volume;
    }

    void UpdateParameter(const Parameters& params, float volume) override {
        // Update parameters for wave generator
    }
private:
    float m_phase = 0.0f;
};
