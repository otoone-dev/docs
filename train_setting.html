<!DOCTYPE html>
<html>
  <head>
	<meta charset="UTF-8">
    <title>TrainTime Setting Page</title>
  </head>
  <body>
    <h1>TrainTime Setting Page</h1>
    
---------<br>
<a href="train_setting_sample.html">Sample is here</a><br>
---------<br>
<p>
<br>
    <input type="radio" name="radio-group" id="radio1" value="0" checked="checked" onclick="radio1Click">Station1
    <input type="radio" name="radio-group" id="radio2" value="1" onclick="radio2Click">Station2
<br>
IconType
<select name="type-select" id="type">
<option value="0">Train</option>
<option value="2">Train15</option>
<option value="3">Bus</option>
<option value="4">Ship</option>
<option value="5">Plane</option>
</select><br>
Color
<select name="color-select" id="color">
<option value="00FF00">Green</option>
<option value="FF0000">Red</option>
<option value="FFAA55">Rajah</option>
<option value="00FFFF">Cyan</option>
<option value="FFFF00">Yellow</option>
<option value="FF00FF">Magenta</option>
<option value="AAAAAA">LightGray</option>
</select><br>
    <textarea id="timetable" cols="30" rows="10" maxlength="6144" wrap="off" placeholder="Input time table data"></textarea>
<br>
    <button id="save_button">Save</button><br>
</p>
   </body>
</html>


<script>
  //Setup to allow easy adding more options later
    var timetable1 = "";
    var timetable2 = "";
    var color1 = 0;
    var color2 = 0;
    var type1 = 0;
    var type2 = 0;
    var restored1 = false;
    var restored2 = false;

  window.onload = function() {
    if (localStorage.watchTimeTable1 != null) {
      timetable1 = localStorage.watchTimeTable1;
      color1 = localStorage.watchTimeColor1;
      type1 = localStorage.watchTimeType1;
      restored1 = true;
    }
    if (localStorage.watchTimeTable2 != null) {
      timetable2 = localStorage.watchTimeTable2;
      color2 = localStorage.watchTimeColor2;
      type2 = localStorage.watchTimeType2;
      restored2 = true;
    }
  }

  function radio1Click() {
    if (restored1) {
      timeTable = document.getElementById("timetable");
      color = document.getElementById("color");
      type = document.getElementById("type");
      
      timeTable.value = timetable1;
      color.value = color1;
      type.value = type1;
    }
  }
  function radio2Click() {
    if (restored2) {
      timeTable = document.getElementById("timetable");
      color = document.getElementById("color");
      type = document.getElementById("type");
      
      timeTable.value = timetable2;
      color.value = color2;
      type.value = type2;
    }
  }

  function saveOptions() {
    
    timeTable = document.getElementById("timetable");
    bank = document.getElementById("radio2");
    color = document.getElementById("color");
    type = document.getElementById("type");
    var options = {
      "time_table": timeTable.value,
      "bank": bank.checked,
      "color": color.value,
      "type": type.value
    }
    if (bank.checked == "checked") {
      localStorage.watchTimeTable2 = timetable2;
      localStorage.watchTimeColor2 = color2;
      localStorage.watchTimeType2 = type2;
    } else {
      localStorage.watchTimeTable1 = timetable1;
      localStorage.watchTimeColor1 = color1;
      localStorage.watchTimeType1 = type1;
    }
    return options;
  };
 
  var submitButton = document.getElementById("save_button");
  submitButton.addEventListener("click", 
    function() {
      console.log("Submit");
 
      var options = saveOptions();
      var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(options));
       
      document.location = location;
    }, 
  false);
</script>
